language: python
services:
    - mongodb
python:
    - "3.6"
    - "3.7"
sudo: required
dist: xenial
install:
    - pip install -r requirements-dev.txt
    - pip install codecov
before_script:
    - python examples/pymodm_autogenerated/download_examples.py
script:
    - coverage run run_doctests.py
    - nosetests --with-coverage --cover-package=fhirbug.server --cover-package=fhirbug.models --cover-package=fhirbug.db --cover-package=fhirbug.config -I fhirsearch_tests
    - nosetests -s --with-coverage --cover-package=fhirbug.server --cover-package=fhirbug.models --cover-package=fhirbug.db --cover-package=fhirbug.config -I fhirsearch_tests examples/pymodm_autogenerated/test_mongo_app.py

after_success:
    - codecov
